id: CVE-2015-1635

info:
  name: Microsoft Windows 'HTTP.sys' - Remote Code Execution
  author: Phillipo
  severity: critical
  description: |
    HTTP.sys in Microsoft Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, and Windows Server 2012 Gold and R2 allows remote attackers to execute arbitrary code via crafted HTTP requests, aka "HTTP.sys Remote Code Execution Vulnerability."
  reference:
    - https://www.exploit-db.com/exploits/36773
    - https://www.securitysift.com/an-analysis-of-ms15-034/
    - https://nvd.nist.gov/vuln/detail/CVE-2015-1635
  classification:
    cvss-metrics: AV:N/AC:L/Au:N/C:C/I:C/A:C
    cvss-score: 10.0
    cwe-id: CWE-94
    cve-id: CVE-2015-1635
    cpe: cpe:2.3:o:microsoft:windows_7:-:sp1:*:*:*:*:*:*
  metadata:
    max-request: 1
    verified: true
    vendor: microsoft
    product: windows_7
    shodan-query: '"Microsoft-IIS" "2015"'
  tags: cve,cve2015,kev,microsoft,iis,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Range: "bytes=0-18446744073709551615"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "HTTP Error 416"
          - "The requested range is not satisfiable"
        condition: and

      - type: word
        part: header
        words:
          - "Microsoft"
# digest: 4b0a0048304602210089c354040a56574a5a17f803370b94a87244e98159c6eff1b1b07f666e2c834a022100936fbfa7282962b47f7de82e84e67d0cc32921b313c84406269eef740f6ccec0:922c64590222798bb761d5b6d8e72950